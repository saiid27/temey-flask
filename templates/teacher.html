<!DOCTYPE html><html lang="fr"><head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>Espace Enseignant</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"></head>
<body class="bg-light">
<nav class="navbar navbar-dark bg-primary">
  <div class="container-fluid"><span class="navbar-brand">أستاذ</span>
    <a class="btn btn-danger btn-sm" href="{{ url_for('logout') }}">تسجيل الخروج</a>
  </div>
</nav>
<div class="container py-4">
  {% with msgs=get_flashed_messages(with_categories=true) %}{% for c,m in msgs %}
  <div class="alert alert-{{c}}">{{m}}</div>{% endfor %}{% endwith %}

  <div class="card shadow mb-4">
    <div class="card-header bg-primary text-white"> رفع دروس</div>
    <div class="card-body">
      <form method="POST" enctype="multipart/form-data" class="row g-3">
        <div class="col-12 col-md-4">
          <label class="form-label">المادة</label>
          <select class="form-select" name="subject" required>
            <option>Math</option><option>Physique</option>
            <option>Chimie</option><option>Science naturelle</option>
          </select>
        </div>
        <div class="col-12 col-md-4"><label class="form-label">Titre du chapitre</label>
          <input name="chapter_title" class="form-control" required></div>
        <div class="col-12 col-md-4">
          <label class="form-label">القسم</label>
          <select class="form-select" name="level" required>
            <option value="4as">4AS</option><option value="7D">7D</option><option value="7O">7O</option>
          </select>
        </div>
        <div class="col-12 col-md-6">
          <label class="form-label">Vidéo (optionnel)</label>
          <input type="file" name="video" class="form-control" accept="video/*">
        </div>
        <div class="col-12 col-md-6">
          <label class="form-label">PDF (optionnel)</label>
          <input type="file" name="pdf" class="form-control" accept="application/pdf">
        </div>
        <div class="col-12"><button class="btn btn-success">إضافة</button></div>
      </form>
    </div>
  </div>

  <h5 class="mb-2">دروسي</h5>
  {% if lessons %}
    {% for l in lessons %}
      <div class="card mb-3"><div class="card-body">
        <b>{{ l.subject }}</b> — {{ l.chapter_title }} — <span class="badge bg-info">{{ l.level }}</span>
        <div class="small text-muted">{{ l.uploaded_at }}</div>
        {% if l.video_file %}
          <video controls class="w-100 mt-2">
            <source src="{{ url_for('static', filename='uploads/videos/' + (l.video_file or '')) }}" type="video/mp4">
          </video>
        {% endif %}
        {% if l.pdf_file %}
          <a target="_blank" class="btn btn-outline-primary btn-sm mt-2"
             href="{{ url_for('static', filename='uploads/pdfs/' + (l.pdf_file or '')) }}">Ouvrir le PDF</a>
        {% endif %}
      </div></div>
    {% endfor %}
  {% else %}
    <div class="alert alert-info">Aucune leçon pour le moment.</div>
  {% endif %}
</div>
</body></html>
