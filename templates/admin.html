<!DOCTYPE html><html lang="fr"><head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>Panneau d’administration</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"></head>
<body class="bg-light">
<nav class="navbar navbar-dark bg-dark">
  <div class="container-fluid">
    <span class="navbar-brand">مشرف</span>
    <a class="btn btn-danger btn-sm" href="{{ url_for('logout') }}">تسجيل الدخول</a>
  </div>
</nav>
<div class="container py-4">
  {% with msgs=get_flashed_messages(with_categories=true) %}{% for c,m in msgs %}
  <div class="alert alert-{{c}}">{{m}}</div>{% endfor %}{% endwith %}

  <h5 class="mb-3">حسابات المستخدمين</h5>
  <div class="table-responsive">
    <table class="table table-bordered align-middle text-center">
      <thead class="table-dark">
        <tr><th>ID</th><th>المستخدم</th><th>رقم الواتساب</th><th>نوعية الحساب</th><th>القسم</th><th>حالة الحساب</th><th> حالة الرقم</th><th>صورة الدفع</th><th>تأكيد او حذف</th></tr>
      </thead>
      <tbody>
        {% for u in users %}
        <tr>
          <td>{{u.id}}</td><td>{{u.username}}</td><td>{{u.phone}}</td>
          <td>{{u.role}}</td><td>{{u.level or '-'}}</td>
          <td>{% if u.status=='pending' %}<span class="badge bg-warning text-dark">في الانتظار </span>{% else %}<span class="badge bg-success">نشط</span>{% endif %}</td>
          <td>{% if u.phone_verified %}<span class="badge bg-success">Oui</span>{% else %}<span class="badge bg-secondary">Non</span>{% endif %}</td>
          <td>
            {% if u.payment_image %}
              <a class="btn btn-outline-secondary btn-sm" target="_blank"
                 href="{{ url_for('static', filename='uploads/payments/' + u.payment_image) }}">عرض الصورة</a>
            {% else %}-{% endif %}
          </td>
          <td class="d-flex gap-2 justify-content-center flex-wrap">
            <a class="btn btn-success btn-sm" href="{{ url_for('activate_user', uid=u.id) }}">قبول</a>
            <a class="btn btn-danger btn-sm" href="{{ url_for('delete_user', uid=u.id) }}">حذف</a>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <hr class="my-4">
  <h5 class="mb-3">انشاءحساب أستاذ</h5>
  <form class="row g-2" method="POST" action="{{ url_for('admin_create_teacher') }}">
    <div class="col-12 col-md-3"><input name="t_username" class="form-control" placeholder="الاسم" required></div>
    <div class="col-12 col-md-3"><input name="t_phone" class="form-control" placeholder="الرقم" required></div>
    <div class="col-12 col-md-3"><input name="t_password" class="form-control" placeholder="كلمة المرور  " required></div>
    <div class="col-12 col-md-2">
      <select name="t_level" class="form-select">
        <option value="">Sans niveau</option>
        <option value="4as">4AS</option><option value="7D">7D</option><option value="7O">7O</option>
      </select>
    </div>
    <div class="col-12 col-md-1"><button class="btn btn-primary w-100">اضافة</button></div>
  </form>
</div>
</body></html>
